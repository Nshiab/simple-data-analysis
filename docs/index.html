<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Simple-data-analysis - v3.0.12</title><meta name="description" content="Documentation for Simple-data-analysis"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">Simple-data-analysis - v3.0.12</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>Simple-data-analysis - v3.0.12</h2></div><div class="tsd-panel tsd-typography"><a id="md:simple-data-analysis-sda-in-javascript" class="tsd-anchor"></a><h1><a href="#md:simple-data-analysis-sda-in-javascript">Simple data analysis (SDA) in JavaScript</a></h1><p>SDA is an easy-to-use and high-performance JavaScript library for data analysis. You can use it with tabular and geospatial data.</p>
<p>The library is maintained by <a href="http://naelshiab.com/">Nael Shiab</a>, computational journalist and senior data producer for <a href="https://www.cbc.ca/news">CBC News</a>.</p>
<p>To install with NPM:</p>
<pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">i</span><span class="hl-1"> </span><span class="hl-0">simple</span><span class="hl-1">-</span><span class="hl-0">data</span><span class="hl-1">-</span><span class="hl-0">analysis</span>
</code><button>Copy</button></pre>
<p>With Bun:</p>
<pre><code><span class="hl-0">bun</span><span class="hl-1"> </span><span class="hl-0">add</span><span class="hl-1"> </span><span class="hl-0">simple</span><span class="hl-1">-</span><span class="hl-0">data</span><span class="hl-1">-</span><span class="hl-0">analysis</span>
</code><button>Copy</button></pre>
<p>The documentation is available <a href="https://nshiab.github.io/simple-data-analysis/">here</a>.</p>
<p>Tests are run for NodeJS and Bun. Deno is coming! :)</p>
<p>You might also find the <a href="https://github.com/nshiab/journalism">journalism library</a> and <a href="https://github.com/nshiab/code-like-a-journalist">Code Like a Journalist</a> interesting.</p>
<a id="md:core-principles" class="tsd-anchor"></a><h2><a href="#md:core-principles">Core principles</a></h2><p>SDA is born out of the frustration of switching between Python, R, and JavaScript to produce data journalism projects. Usually, data crunching and analysis are done with Python or R, and interactive data visualizations are coded in JavaScript. However, being proficient in multiple programming languages is hard. Why can&#39;t we do everything in JS?</p>
<p>The missing piece in the JavaScript/TypeScript ecosystem was an easy-to-use and performant library for data analysis. This is why SDA was created.</p>
<p>The library is based on <a href="https://duckdb.org/">DuckDB</a>, a fast in-process analytical database. Under the hood, SDA sends SQL queries to be executed by DuckDB. We use <a href="https://github.com/duckdb/duckdb-node">duckdb-node</a> and <a href="https://github.com/duckdb/duckdb-wasm">duckdb-wasm</a>. This means SDA can run in the browser and with NodeJS and other runtimes. For geospatial computations, we rely on the <a href="https://github.com/duckdb/duckdb_spatial">duckdb_spatial</a></p>
<p>The syntax and the available methods were inspired by <a href="https://github.com/pandas-dev/pandas">Pandas</a> (Python) and the <a href="https://www.tidyverse.org/">Tidyverse</a> (R).</p>
<p>You can also write your own SQL queries if you want to (check the <a href="https://nshiab.github.io/simple-data-analysis/classes/SimpleWebDB.html#customQuery">customQuery method</a>) or use JavaScript to process your data (check the <a href="https://nshiab.github.io/simple-data-analysis/classes/SimpleWebTable.html#updateWithJS">updateWithJS method</a>).</p>
<p>Feel free to start a conversation or open an issue. Check how you can <a href="https://github.com/nshiab/simple-data-analysis/blob/main/CONTRIBUTING.md">contribute</a>.</p>
<a id="md:performance" class="tsd-anchor"></a><h2><a href="#md:performance">Performance</a></h2><p>To test and compare the library&#39;s performance, we calculated the average temperature per decade and city with the daily temperatures from the <a href="https://api.weather.gc.ca/collections/ahccd-annual">Adjusted and Homogenized Canadian Climate Data</a>. See <a href="https://github.com/nshiab/simple-data-analysis-benchmarks">this repository</a> for the code.</p>
<p>We ran the same calculations with <strong><a href="mailto:simple-data-analysis@3.0.0">simple-data-analysis@3.0.0</a></strong> (both NodeJS and Bun), <strong>Pandas (Python)</strong>, and the <strong>tidyverse (R)</strong>.</p>
<p>In each script, we:</p>
<ol>
<li>Loaded a CSV file (<em>Importing</em>)</li>
<li>Selected four columns, removed rows with missing temperature, converted date strings to date and temperature strings to float (<em>Cleaning</em>)</li>
<li>Added a new column <em>decade</em> and calculated the decade (<em>Modifying</em>)</li>
<li>Calculated the average temperature per decade and city (<em>Summarizing</em>)</li>
<li>Wrote the cleaned-up data that we computed the averages from in a new CSV file (<em>Writing</em>)</li>
</ol>
<p>Each script has been run ten times on a MacBook Pro (Apple M1 Pro / 16 GB).</p>
<a id="md:small-file" class="tsd-anchor"></a><h3><a href="#md:small-file">Small file</a></h3><p>With <em>ahccd-samples.csv</em>:</p>
<ul>
<li>74.7 MB</li>
<li>19 cities</li>
<li>20 columns</li>
<li>971,804 rows</li>
<li>19,436,080 data points</li>
</ul>
<p><strong><a href="mailto:simple-data-analysis@3.0.0">simple-data-analysis@3.0.0</a></strong> is the fastest, but if we skip writing the CSV file, the <strong>tidyverse</strong> shows impressive speed with small files.</p>
<p><img src="./assets/small-file.png" alt="A chart showing the processing duration of multiple scripts in various languages"></p>
<a id="md:big-file" class="tsd-anchor"></a><h3><a href="#md:big-file">Big file</a></h3><p>With <em>ahccd.csv</em>:</p>
<ul>
<li>1.7 GB</li>
<li>773 cities</li>
<li>20 columns</li>
<li>22,051,025 rows</li>
<li>441,020,500 data points</li>
</ul>
<p>Thanks to DuckDB, <strong><a href="mailto:simple-data-analysis@3.0.0">simple-data-analysis@3.0.0</a></strong> really shines with big files. It&#39;s the fastest option.</p>
<p><img src="./assets/big-file.png" alt="A chart showing the processing duration of multiple scripts in various languages"></p>
<p>We also tried the One Billion Row Challenge, which involves computing the min, mean, and max temperatures for hundreds of cities in a 1,000,000,000 rows CSV file. The library has been able to crunch the numbers in 1 minute 32 seconds on the same computer (Apple M1 Pro / 16 GB). For more, check this <a href="https://github.com/nshiab/1brc">repo</a> forked from this <a href="https://github.com/gunnarmorling/1brc">one</a>. The JavaScript code is <a href="https://github.com/nshiab/1brc/blob/main/index.js">here</a>.</p>
<p>Note that DuckDB, which powers SDA, can also be used with <a href="https://duckdb.org/docs/api/python/overview.html">Python</a> and <a href="https://duckdb.org/docs/api/r">R</a>.</p>
<a id="md:sda-in-an-observable-notebook" class="tsd-anchor"></a><h2><a href="#md:sda-in-an-observable-notebook">SDA in an Observable notebook</a></h2><p>Observable notebooks are great for data analysis in JavaScript.</p>
<p>In this <a href="https://observablehq.com/@nshiab/hello-simple-data-analysis?collection=@nshiab/simple-data-analysis-in-javascript">example</a>, we calculate the average temperature per decade in three cities and check for trends. We will also join two tables to retrieve the names of the cities.</p>
<p>This <a href="https://observablehq.com/@nshiab/hello-simple-data-analysis-and-geospatial-data?collection=@nshiab/simple-data-analysis-in-javascript">other example</a> focuses on geospatial analysis. We create point geometries from the latitude and longitude of 2023 wildfires in Canada, do a spatial join with provinces&#39; boundaries, and then compute the number of fires and the total area burnt per province.</p>
<a id="md:sda-in-an-html-page" class="tsd-anchor"></a><h2><a href="#md:sda-in-an-html-page">SDA in an HTML page</a></h2><p>If you want to add the library directly to your webpage, you can use a npm-based CDN like jsDelivr.</p>
<p>Here&#39;s some code you can copy and paste into an HTML file.</p>
<p>In this example, we load a CSV file with the latitude and longitude of 2023 wildfires in Canada, create point geometries from it, do a spatial join with provinces boundaries, and then compute the number of fires and the total area burnt per province.</p>
<p>You could also use a framework or a bundler. Install the library with npm <code>npm i simple-data-analysis</code> and import it into your project <code>import { SimpleWebDB } from &#39;simple-data-analysis&#39;</code>.</p>
<pre><code class="language-html"><span class="hl-2">&lt;</span><span class="hl-3">script</span><span class="hl-4"> </span><span class="hl-5">type</span><span class="hl-4">=</span><span class="hl-6">&quot;module&quot;</span><span class="hl-2">&gt;</span><br/><span class="hl-4">    </span><span class="hl-7">// We import the SimpleWebDB class from the esm bundle.</span><br/><span class="hl-4">    </span><span class="hl-8">import</span><span class="hl-4"> { </span><span class="hl-0">SimpleWebDB</span><span class="hl-4"> } </span><span class="hl-8">from</span><span class="hl-4"> </span><span class="hl-9">&quot;https://cdn.jsdelivr.net/npm/simple-data-analysis@3.0.0/+esm&quot;</span><br/><br/><span class="hl-4">    </span><span class="hl-10">async</span><span class="hl-4"> </span><span class="hl-10">function</span><span class="hl-4"> </span><span class="hl-11">main</span><span class="hl-4">() {</span><br/><span class="hl-4">        </span><span class="hl-7">// We start a SimpleWebDB instance.</span><br/><span class="hl-4">        </span><span class="hl-10">const</span><span class="hl-4"> </span><span class="hl-12">sdb</span><span class="hl-4"> </span><span class="hl-1">=</span><span class="hl-4"> </span><span class="hl-10">new</span><span class="hl-4"> </span><span class="hl-11">SimpleWebDB</span><span class="hl-4">()</span><br/><br/><span class="hl-4">        </span><span class="hl-7">// We create a new table.</span><br/><span class="hl-4">        </span><span class="hl-10">const</span><span class="hl-4"> </span><span class="hl-12">provinces</span><span class="hl-4"> </span><span class="hl-1">=</span><span class="hl-4"> </span><span class="hl-0">sdb</span><span class="hl-4">.</span><span class="hl-11">newTable</span><span class="hl-4">(</span><span class="hl-9">&quot;provinces&quot;</span><span class="hl-4">)</span><br/><span class="hl-4">        </span><span class="hl-7">// We fetch the provinces&#39; boundaries. It&#39;s a geoJSON.</span><br/><span class="hl-4">        </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">provinces</span><span class="hl-4">.</span><span class="hl-11">fetchGeoData</span><span class="hl-4">(</span><br/><span class="hl-4">            </span><span class="hl-9">&quot;https://raw.githubusercontent.com/nshiab/simple-data-analysis/main/test/geodata/files/CanadianProvincesAndTerritories.json&quot;</span><br/><span class="hl-4">        )</span><br/><span class="hl-4">        </span><span class="hl-7">// We log the provinces.</span><br/><span class="hl-4">        </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">provinces</span><span class="hl-4">.</span><span class="hl-11">logTable</span><span class="hl-4">()</span><br/><br/><span class="hl-4">        </span><span class="hl-7">// We create a new table.</span><br/><span class="hl-4">        </span><span class="hl-10">const</span><span class="hl-4"> </span><span class="hl-12">fires</span><span class="hl-4"> </span><span class="hl-1">=</span><span class="hl-4"> </span><span class="hl-0">sdb</span><span class="hl-4">.</span><span class="hl-11">newTable</span><span class="hl-4">(</span><span class="hl-9">&quot;fires&quot;</span><span class="hl-4">)</span><br/><span class="hl-4">        </span><span class="hl-7">// We fetch the wildfires data. It&#39;s a CSV.</span><br/><span class="hl-4">        </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">fires</span><span class="hl-4">.</span><span class="hl-11">fetchData</span><span class="hl-4">(</span><br/><span class="hl-4">            </span><span class="hl-9">&quot;https://raw.githubusercontent.com/nshiab/simple-data-analysis/main/test/geodata/files/firesCanada2023.csv&quot;</span><br/><span class="hl-4">        )</span><br/><span class="hl-4">        </span><span class="hl-7">// We create point geometries from the lat and lon columns</span><br/><span class="hl-4">        </span><span class="hl-7">// and we store the points in the new column geom.</span><br/><span class="hl-4">        </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">fires</span><span class="hl-4">.</span><span class="hl-11">points</span><span class="hl-4">(</span><span class="hl-9">&quot;lat&quot;</span><span class="hl-4">, </span><span class="hl-9">&quot;lon&quot;</span><span class="hl-4">, </span><span class="hl-9">&quot;geom&quot;</span><span class="hl-4">)</span><br/><span class="hl-4">        </span><span class="hl-7">// We log the fires</span><br/><span class="hl-4">        </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">fires</span><span class="hl-4">.</span><span class="hl-11">logTable</span><span class="hl-4">()</span><br/><br/><span class="hl-4">        </span><span class="hl-7">// We match fires with provinces</span><br/><span class="hl-4">        </span><span class="hl-7">// and we output the results into a new table.</span><br/><span class="hl-4">        </span><span class="hl-7">// By default, joinGeo will automatically look</span><br/><span class="hl-4">        </span><span class="hl-7">// for columns storing geometries in the tables,</span><br/><span class="hl-4">        </span><span class="hl-7">// do a left join, and put the results</span><br/><span class="hl-4">        </span><span class="hl-7">// in the left table.</span><br/><span class="hl-4">        </span><span class="hl-10">const</span><span class="hl-4"> </span><span class="hl-12">firesInsideProvinces</span><span class="hl-4"> </span><span class="hl-1">=</span><span class="hl-4"> </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">fires</span><span class="hl-4">.</span><span class="hl-11">joinGeo</span><span class="hl-4">(</span><span class="hl-0">provinces</span><span class="hl-4">, </span><span class="hl-9">&quot;inside&quot;</span><span class="hl-4">, {</span><br/><span class="hl-4">            </span><span class="hl-0">outputTable:</span><span class="hl-4"> </span><span class="hl-9">&quot;firesInsideProvinces&quot;</span><span class="hl-4">,</span><br/><span class="hl-4">        })</span><br/><br/><span class="hl-4">        </span><span class="hl-7">// We summarize to count the number of fires</span><br/><span class="hl-4">        </span><span class="hl-7">// and sum up the area burnt in each province.</span><br/><span class="hl-4">        </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">firesInsideProvinces</span><span class="hl-4">.</span><span class="hl-11">summarize</span><span class="hl-4">({</span><br/><span class="hl-4">            </span><span class="hl-0">values:</span><span class="hl-4"> </span><span class="hl-9">&quot;hectares&quot;</span><span class="hl-4">,</span><br/><span class="hl-4">            </span><span class="hl-0">categories:</span><span class="hl-4"> </span><span class="hl-9">&quot;nameEnglish&quot;</span><span class="hl-4">,</span><br/><span class="hl-4">            </span><span class="hl-0">summaries:</span><span class="hl-4"> [</span><span class="hl-9">&quot;count&quot;</span><span class="hl-4">, </span><span class="hl-9">&quot;sum&quot;</span><span class="hl-4">],</span><br/><span class="hl-4">            </span><span class="hl-0">decimals:</span><span class="hl-4"> </span><span class="hl-13">0</span><span class="hl-4">,</span><br/><span class="hl-4">        })</span><br/><span class="hl-4">        </span><span class="hl-7">// We rename columns.</span><br/><span class="hl-4">        </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">firesInsideProvinces</span><span class="hl-4">.</span><span class="hl-11">renameColumns</span><span class="hl-4">({</span><br/><span class="hl-4">            </span><span class="hl-0">count:</span><span class="hl-4"> </span><span class="hl-9">&quot;nbFires&quot;</span><span class="hl-4">,</span><br/><span class="hl-4">            </span><span class="hl-0">sum:</span><span class="hl-4"> </span><span class="hl-9">&quot;burntArea&quot;</span><span class="hl-4">,</span><br/><span class="hl-4">        })</span><br/><span class="hl-4">        </span><span class="hl-7">// We want the province with</span><br/><span class="hl-4">        </span><span class="hl-7">// the greatest burnt area first.</span><br/><span class="hl-4">        </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">firesInsideProvinces</span><span class="hl-4">.</span><span class="hl-11">sort</span><span class="hl-4">({ </span><span class="hl-0">burntArea:</span><span class="hl-4"> </span><span class="hl-9">&quot;desc&quot;</span><span class="hl-4"> })</span><br/><br/><span class="hl-4">        </span><span class="hl-7">// We log the results. By default, the method</span><br/><span class="hl-4">        </span><span class="hl-7">// logs the first 10 rows, but there are 13</span><br/><span class="hl-4">        </span><span class="hl-7">// provinces and territories in Canada.</span><br/><span class="hl-4">        </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">firesInsideProvinces</span><span class="hl-4">.</span><span class="hl-11">logTable</span><span class="hl-4">(</span><span class="hl-13">13</span><span class="hl-4">)</span><br/><br/><span class="hl-4">        </span><span class="hl-7">// We can also retrieve the data as an array of objects.</span><br/><span class="hl-4">        </span><span class="hl-10">const</span><span class="hl-4"> </span><span class="hl-12">data</span><span class="hl-4"> </span><span class="hl-1">=</span><span class="hl-4"> </span><span class="hl-8">await</span><span class="hl-4"> </span><span class="hl-0">firesInsideProvinces</span><span class="hl-4">.</span><span class="hl-11">getData</span><span class="hl-4">()</span><br/><span class="hl-4">        </span><span class="hl-0">console</span><span class="hl-4">.</span><span class="hl-11">log</span><span class="hl-4">(</span><span class="hl-0">data</span><span class="hl-4">)</span><br/><span class="hl-4">    }</span><br/><br/><span class="hl-4">    </span><span class="hl-11">main</span><span class="hl-4">()</span><br/><span class="hl-2">&lt;/</span><span class="hl-3">script</span><span class="hl-2">&gt;</span>
</code><button>Copy</button></pre>
<p>And here&#39;s what you&#39;ll see in your browser&#39;s console tab.</p>
<p><img src="./assets/browser-console.png" alt="The console tab in Google Chrome showing the result of simple-data-analysis computations."></p>
<a id="md:sda-with-nodejs-and-similar-runtimes" class="tsd-anchor"></a><h2><a href="#md:sda-with-nodejs-and-similar-runtimes">SDA with NodeJS and similar runtimes</a></h2><p>First, ensure that you have <a href="https://nodejs.org/en/">NodeJS v20 or higher</a> installed.</p>
<p>Then, run this command to install the library in your code repository.</p>
<pre><code class="language-bash"><span class="hl-11">npm</span><span class="hl-1"> </span><span class="hl-9">i</span><span class="hl-1"> </span><span class="hl-9">simple-data-analysis@3.0.0</span>
</code><button>Copy</button></pre>
<p>A <em>package.json</em> file should have been created. Open it and add or change the type to &quot;module&quot; to use a modern syntax. If you use Bun, you can skip this step.</p>
<pre><code class="language-json"><span class="hl-1">{</span><br/><span class="hl-1">    </span><span class="hl-14">&quot;type&quot;</span><span class="hl-1">: </span><span class="hl-9">&quot;module&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-14">&quot;dependencies&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-14">&quot;simple-data-analysis&quot;</span><span class="hl-1">: </span><span class="hl-9">&quot;^3.0.0&quot;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>Copy and paste the code below into an <code>index.js</code> file and run it with <code>node index.js</code>.</p>
<p>In this example, we load a CSV file with the latitude and longitude of 2023 wildfires in Canada, create point geometries from it, do a spatial join with provinces&#39; boundaries, and then compute the number of fires and the total area burnt per province.</p>
<p>It&#39;s the same code as the one you would run in a browser, except we use the <em>SimpleDB</em> class instead of <em>SimpleWebDB</em> and <em>loadData</em> instead of <em>fetchData</em>.</p>
<p>With NodeJS and other runtimes, more methods are available to load and write data from/to local files. Check the <a href="https://nshiab.github.io/simple-data-analysis/classes/SimpleTable.html">SimpleTable class documentation</a>.</p>
<pre><code class="language-ts"><span class="hl-8">import</span><span class="hl-1"> { </span><span class="hl-0">SimpleDB</span><span class="hl-1"> } </span><span class="hl-8">from</span><span class="hl-1"> </span><span class="hl-9">&quot;simple-data-analysis&quot;</span><br/><br/><span class="hl-7">// We start a SimpleDB instance.</span><br/><span class="hl-10">const</span><span class="hl-1"> </span><span class="hl-12">sdb</span><span class="hl-1"> = </span><span class="hl-10">new</span><span class="hl-1"> </span><span class="hl-11">SimpleDB</span><span class="hl-1">()</span><br/><br/><span class="hl-7">// We create a new table.</span><br/><span class="hl-10">const</span><span class="hl-1"> </span><span class="hl-12">provinces</span><span class="hl-1"> = </span><span class="hl-0">sdb</span><span class="hl-1">.</span><span class="hl-11">newTable</span><span class="hl-1">(</span><span class="hl-9">&quot;provinces&quot;</span><span class="hl-1">)</span><br/><span class="hl-7">// We fetch the provinces&#39; boundaries. It&#39;s a geoJSON.</span><br/><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">provinces</span><span class="hl-1">.</span><span class="hl-11">loadGeoData</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;https://raw.githubusercontent.com/nshiab/simple-data-analysis/main/test/geodata/files/CanadianProvincesAndTerritories.json&quot;</span><br/><span class="hl-1">)</span><br/><span class="hl-7">// We log the provinces.</span><br/><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">provinces</span><span class="hl-1">.</span><span class="hl-11">logTable</span><span class="hl-1">()</span><br/><br/><span class="hl-7">// We create a new table.</span><br/><span class="hl-10">const</span><span class="hl-1"> </span><span class="hl-12">fires</span><span class="hl-1"> = </span><span class="hl-0">sdb</span><span class="hl-1">.</span><span class="hl-11">newTable</span><span class="hl-1">(</span><span class="hl-9">&quot;fires&quot;</span><span class="hl-1">)</span><br/><span class="hl-7">// We fetch the wildfires data. It&#39;s a CSV.</span><br/><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">fires</span><span class="hl-1">.</span><span class="hl-11">loadData</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;https://raw.githubusercontent.com/nshiab/simple-data-analysis/main/test/geodata/files/firesCanada2023.csv&quot;</span><br/><span class="hl-1">)</span><br/><span class="hl-7">// We create point geometries from the lat and lon columns</span><br/><span class="hl-7">// and we store the points in the new column geom.</span><br/><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">fires</span><span class="hl-1">.</span><span class="hl-11">points</span><span class="hl-1">(</span><span class="hl-9">&quot;lat&quot;</span><span class="hl-1">, </span><span class="hl-9">&quot;lon&quot;</span><span class="hl-1">, </span><span class="hl-9">&quot;geom&quot;</span><span class="hl-1">)</span><br/><span class="hl-7">// We log the fires.</span><br/><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">fires</span><span class="hl-1">.</span><span class="hl-11">logTable</span><span class="hl-1">()</span><br/><br/><span class="hl-7">// We match fires with provinces</span><br/><span class="hl-7">// and we output the results into a new table.</span><br/><span class="hl-7">// By default, joinGeo will automatically look</span><br/><span class="hl-7">// for columns storing geometries in the tables,</span><br/><span class="hl-7">// do a left join, and put the results</span><br/><span class="hl-7">// in the left table.</span><br/><span class="hl-10">const</span><span class="hl-1"> </span><span class="hl-12">firesInsideProvinces</span><span class="hl-1"> = </span><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">fires</span><span class="hl-1">.</span><span class="hl-11">joinGeo</span><span class="hl-1">(</span><span class="hl-0">provinces</span><span class="hl-1">, </span><span class="hl-9">&quot;inside&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-0">outputTable:</span><span class="hl-1"> </span><span class="hl-9">&quot;firesInsideProvinces&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-7">// We summarize to count the number of fires</span><br/><span class="hl-7">// and sum up the area burnt in each province.</span><br/><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">firesInsideProvinces</span><span class="hl-1">.</span><span class="hl-11">summarize</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-0">values:</span><span class="hl-1"> </span><span class="hl-9">&quot;hectares&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">categories:</span><span class="hl-1"> </span><span class="hl-9">&quot;nameEnglish&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">summaries:</span><span class="hl-1"> [</span><span class="hl-9">&quot;count&quot;</span><span class="hl-1">, </span><span class="hl-9">&quot;sum&quot;</span><span class="hl-1">],</span><br/><span class="hl-1">    </span><span class="hl-0">decimals:</span><span class="hl-1"> </span><span class="hl-13">0</span><span class="hl-1">,</span><br/><span class="hl-1">})</span><br/><span class="hl-7">// We rename columns.</span><br/><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">firesInsideProvinces</span><span class="hl-1">.</span><span class="hl-11">renameColumns</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-0">count:</span><span class="hl-1"> </span><span class="hl-9">&quot;nbFires&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">sum:</span><span class="hl-1"> </span><span class="hl-9">&quot;burntArea&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">})</span><br/><span class="hl-7">// We want the province with</span><br/><span class="hl-7">// the greatest burnt area first.</span><br/><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">firesInsideProvinces</span><span class="hl-1">.</span><span class="hl-11">sort</span><span class="hl-1">({ </span><span class="hl-0">burntArea:</span><span class="hl-1"> </span><span class="hl-9">&quot;desc&quot;</span><span class="hl-1"> })</span><br/><br/><span class="hl-7">// We log the results. By default, the method</span><br/><span class="hl-7">// logs the first 10 rows, but there are 13</span><br/><span class="hl-7">// provinces and territories in Canada.</span><br/><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-0">firesInsideProvinces</span><span class="hl-1">.</span><span class="hl-11">logTable</span><span class="hl-1">(</span><span class="hl-13">13</span><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>And here&#39;s what you should see in your console.</p>
<p><img src="./assets/nodejs-console.png" alt="The console tab in Google Chrome showing the result of simple-data-analysis computations."></p>
<p>If you want to generate and save charts with NodeJS and other runtimes, check the <a href="https://github.com/nshiab/journalism">journalism library</a>, more specifically the <a href="https://nshiab.github.io/journalism/functions/savePlotChart.html">savePlotChart function</a>.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:simple-data-analysis-sda-in-javascript"><span>Simple data analysis (SDA) in <wbr/>Java<wbr/>Script</span></a><ul><li><a href="#md:core-principles"><span>Core principles</span></a></li><li><a href="#md:performance"><span>Performance</span></a></li><li><ul><li><a href="#md:small-file"><span>Small file</span></a></li><li><a href="#md:big-file"><span>Big file</span></a></li></ul></li><li><a href="#md:sda-in-an-observable-notebook"><span>SDA in an <wbr/>Observable notebook</span></a></li><li><a href="#md:sda-in-an-html-page"><span>SDA in an HTML page</span></a></li><li><a href="#md:sda-with-nodejs-and-similar-runtimes"><span>SDA with <wbr/>NodeJS and similar runtimes</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>Simple-data-analysis - v3.0.12</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>